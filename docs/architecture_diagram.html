<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenLiberty RealWorld Architecture</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.2.3/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100vw;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 20px;
            text-align: center;
            flex-shrink: 0;
            border-bottom: 2px solid rgba(255,255,255,0.1);
        }

        .header h1 {
            font-size: 1.4em;
            margin-bottom: 2px;
            font-weight: 600;
        }

        .header p {
            font-size: 0.9em;
            opacity: 0.9;
            font-weight: 400;
        }

        .zoom-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8f9fa;
            padding: 8px 20px;
            border-bottom: 1px solid #dee2e6;
            flex-shrink: 0;
        }

        .status-message {
            font-size: 12px;
            font-weight: 500;
        }

        .status-positive {
            color: #000;
        }

        .status-negative {
            color: #dc3545;
        }

        .zoom-controls-group {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .usage-hint {
            font-size: 11px;
            color: #666;
            font-style: italic;
        }

        .zoom-buttons {
            display: flex;
            gap: 6px;
        }

        .zoom-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
            transition: background-color 0.2s;
        }

        .zoom-btn:hover {
            background: #0056b3;
        }

        #diagram {
            flex: 1;
            position: relative;
            overflow: auto;
            background: #fafafa;
        }

        .zoom-level-indicator {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 11px;
            z-index: 1000;
            pointer-events: none;
        }

        .diagram-container {
            display: inline-block;
            margin: 0 auto;
            transform-origin: center center;
            transition: transform 0.3s ease;
        }

        .mermaid {
            margin: 0 auto;
        }

        .legend {
            background: #f8f9fa;
            border-top: 1px solid #dee2e6;
            padding: 10px;
            flex-shrink: 0;
            max-height: 100px;
            overflow-y: auto;
        }

        .legend-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 6px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 4px;
            background: white;
            border-radius: 3px;
            border: 1px solid #e1e5e9;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            flex-shrink: 0;
        }

        .legend-label {
            font-size: 11px;
            font-weight: 500;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>OpenLiberty RealWorld Architecture</h1>
            <p>System Architecture Diagram</p>
        </div>

        <div class="zoom-controls">
            <div class="status-message status-positive">Click components/boxes below to view source files on GitHub</div>
            <div class="zoom-controls-group">
                <span class="usage-hint">Use Ctrl/Cmd + mouse wheel or keyboard (+/- keys) to zoom</span>
                <div class="zoom-buttons">
                    <button class="zoom-btn" onclick="zoomIn()">+ Zoom In</button>
                    <button class="zoom-btn" onclick="zoomOut()">- Zoom Out</button>
                    <button class="zoom-btn" onclick="resetZoom()">Reset</button>
                </div>
            </div>
        </div>

        <div id="diagram">
            <div class="zoom-level-indicator" id="zoomIndicator">25%</div>
            <div class="diagram-container">
                <div class="mermaid">
                    flowchart TD
                        %% Client Interaction Layer
                        Client["üåê Client Applications<br/>(Frontend / Mobile / API Consumer)"]
                        
                        %% Authentication & Security Layer
                        subgraph "Authentication & Security"
                            JWT["üîê JWT Generator<br/>(MicroProfile JWT 1.0)"]
                            Auth["üõ°Ô∏è Authorization<br/>(@RolesAllowed)"]
                        end
                        
                        %% REST API Layer
                        subgraph "JAX-RS REST API Layer"
                            Health["‚ù§Ô∏è Health Endpoint<br/>(MicroProfile Health)"]
                            UsersAPI["üë§ Users API<br/>(Registration & Login)"]
                            ArticlesAPI["üìù Articles API<br/>(CRUD Operations)"]
                            ProfilesAPI["üë• Profiles API<br/>(Social Features)"]
                            TagsAPI["üè∑Ô∏è Tags API<br/>(Content Organization)"]
                        end
                        
                        %% Business Logic & Data Access Layer
                        subgraph "Data Access Layer (DAO Pattern)"
                            UserDao["üë§ User DAO<br/>(User Operations)"]
                            ArticleDao["üìù Article DAO<br/>(Article Operations)"]
                            UserContext["üîÑ User Context<br/>(Business Logic)"]
                        end
                        
                        %% Core Domain Entities
                        subgraph "JPA Entity Layer"
                            UserEntity["üë§ User Entity<br/>(Account Data)"]
                            ProfileEntity["üë• Profile Entity<br/>(Public Profile)"]
                            ArticleEntity["üìù Article Entity<br/>(Content Data)"]
                            CommentEntity["üí¨ Comment Entity<br/>(Discussion Data)"]
                        end
                        
                        %% Persistence Layer
                        subgraph "Persistence & Infrastructure"
                            JPA["üóÉÔ∏è JPA 2.2<br/>(EclipseLink ORM)"]
                            Derby["üóÑÔ∏è Derby Database<br/>(Embedded)"]
                            Liberty["‚öôÔ∏è Open Liberty Server<br/>(MicroProfile 3.0)"]
                        end
                        
                        %% External Libraries
                        subgraph "External Dependencies"
                            Jersey["üåê Jersey 2.30.1<br/>(JAX-RS Implementation)"]
                            Slugify["üîó Slugify Library<br/>(URL Generation)"]
                            JsonLib["üìã JSON Library<br/>(org.json)"]
                        end
                        
                        %% Flow Connections
                        Client --> Auth
                        Client --> Health
                        
                        Auth --> UsersAPI
                        Auth --> ArticlesAPI
                        Auth --> ProfilesAPI
                        Auth --> TagsAPI
                        
                        UsersAPI --> JWT
                        UsersAPI --> UserDao
                        
                        ArticlesAPI --> UserDao
                        ArticlesAPI --> ArticleDao
                        ArticlesAPI --> Slugify
                        
                        ProfilesAPI --> UserContext
                        TagsAPI --> ArticleDao
                        
                        UserDao --> UserContext
                        ArticleDao --> UserContext
                        
                        UserDao --> UserEntity
                        UserDao --> ProfileEntity
                        ArticleDao --> ArticleEntity
                        ArticleDao --> CommentEntity
                        
                        UserEntity --> JPA
                        ProfileEntity --> JPA
                        ArticleEntity --> JPA
                        CommentEntity --> JPA
                        
                        JPA --> Derby
                        
                        UsersAPI --> Jersey
                        ArticlesAPI --> Jersey
                        ProfilesAPI --> Jersey
                        TagsAPI --> Jersey
                        Health --> Jersey
                        
                        ArticlesAPI --> JsonLib
                        UsersAPI --> JsonLib
                        
                        Liberty -.-> JPA
                        Liberty -.-> Derby
                        Liberty -.-> Jersey
                        
                        %% Component Click Events (GitHub Links)
                        click Health href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/java/application/rest/HealthEndpoint.java" _blank
                        click JWT href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/java/security/JwtGenerator.java" _blank
                        click UsersAPI href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/java/application/rest/UsersAPI.java" _blank
                        click ArticlesAPI href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/java/application/rest/ArticlesAPI.java" _blank
                        click ProfilesAPI href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/java/application/rest/ProfilesAPI.java" _blank
                        click TagsAPI href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/java/application/rest/TagsAPI.java" _blank
                        click UserDao href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/java/dao/UserDao.java" _blank
                        click ArticleDao href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/java/dao/ArticleDao.java" _blank
                        click UserContext href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/java/dao/UserContext.java" _blank
                        click UserEntity href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/java/core/user/User.java" _blank
                        click ProfileEntity href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/java/core/user/Profile.java" _blank
                        click ArticleEntity href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/java/core/article/Article.java" _blank
                        click CommentEntity href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/java/core/comments/Comment.java" _blank
                        click Liberty href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/liberty/config/server.xml" _blank
                        click JPA href "https://github.com/jiteshy/openliberty-realworld-example-app/blob/main/src/main/resources/META-INF/persistence.xml" _blank
                        
                        %% Styling
                        classDef clientStyle fill:#e1f5fe,stroke:#01579b,stroke-width:2px
                        classDef authStyle fill:#fff3e0,stroke:#e65100,stroke-width:2px
                        classDef apiStyle fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
                        classDef daoStyle fill:#fff8e1,stroke:#ff6f00,stroke-width:2px
                        classDef entityStyle fill:#fce4ec,stroke:#880e4f,stroke-width:2px
                        classDef persistStyle fill:#f1f8e9,stroke:#33691e,stroke-width:2px
                        classDef libStyle fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
                        
                        class Client clientStyle
                        class JWT,Auth authStyle
                        class Health,UsersAPI,ArticlesAPI,ProfilesAPI,TagsAPI apiStyle
                        class UserDao,ArticleDao,UserContext daoStyle
                        class UserEntity,ProfileEntity,ArticleEntity,CommentEntity entityStyle
                        class JPA,Derby,Liberty persistStyle
                        class Jersey,Slugify,JsonLib libStyle
                </div>
            </div>
        </div>

        <div class="legend">
            <div class="legend-grid">
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #e1f5fe; border: 1px solid #01579b;"></div>
                    <span class="legend-label">Client Layer</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #fff3e0; border: 1px solid #e65100;"></div>
                    <span class="legend-label">Authentication</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #e8f5e8; border: 1px solid #1b5e20;"></div>
                    <span class="legend-label">REST API</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #fff8e1; border: 1px solid #ff6f00;"></div>
                    <span class="legend-label">Data Access</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #fce4ec; border: 1px solid #880e4f;"></div>
                    <span class="legend-label">JPA Entities</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #f1f8e9; border: 1px solid #33691e;"></div>
                    <span class="legend-label">Persistence</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        let zoomLevel = 0.25;
        const minZoom = 0.15;
        const maxZoom = 3;

        // Initialize Mermaid with loose security level for GitHub links
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: { 
                useMaxWidth: false, 
                htmlLabels: true 
            },
            securityLevel: 'loose'
        });

        function updateZoom() {
            const container = document.querySelector('.diagram-container');
            container.style.transform = `scale(${zoomLevel})`;
            document.getElementById('zoomIndicator').textContent = Math.round(zoomLevel * 100) + '%';
        }

        function zoomIn() {
            if (zoomLevel < maxZoom) {
                zoomLevel = Math.min(maxZoom, zoomLevel + 0.1);
                updateZoom();
            }
        }

        function zoomOut() {
            if (zoomLevel > minZoom) {
                zoomLevel = Math.max(minZoom, zoomLevel - 0.1);
                updateZoom();
            }
        }

        function resetZoom() {
            zoomLevel = 0.25;
            updateZoom();
            centerDiagram();
        }

        function centerDiagram() {
            const diagramElement = document.getElementById('diagram');
            const diagramContainer = document.querySelector('.diagram-container');
            
            setTimeout(() => {
                const scrollLeft = (diagramElement.scrollWidth - diagramElement.clientWidth) / 2;
                const scrollTop = (diagramElement.scrollHeight - diagramElement.clientHeight) / 2;
                
                diagramElement.scrollLeft = scrollLeft;
                diagramElement.scrollTop = scrollTop;
            }, 100);
        }

        // Keyboard support
        document.addEventListener('keydown', function(e) {
            if (e.target.tagName.toLowerCase() === 'input') return;
            
            switch(e.key) {
                case '+':
                case '=':
                    e.preventDefault();
                    zoomIn();
                    break;
                case '-':
                    e.preventDefault();
                    zoomOut();
                    break;
                case '0':
                    e.preventDefault();
                    resetZoom();
                    break;
            }
        });

        // Mouse wheel support
        document.getElementById('diagram').addEventListener('wheel', function(e) {
            if (e.ctrlKey || e.metaKey) {
                e.preventDefault();
                if (e.deltaY < 0) {
                    zoomIn();
                } else {
                    zoomOut();
                }
            }
        });

        // Initialize on page load
        window.addEventListener('load', function() {
            updateZoom();
            setTimeout(centerDiagram, 500);
        });
    </script>
</body>
</html> 